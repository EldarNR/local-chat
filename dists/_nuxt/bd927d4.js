(window.webpackJsonp=window.webpackJsonp||[]).push([[5,2,3,4],{279:function(e,t,r){"use strict";var n=r(2),l=r(202).trim;n({target:"String",proto:!0,forced:r(280)("trim")},{trim:function(){return l(this)}})},280:function(e,t,r){"use strict";var n=r(86).PROPER,l=r(3),o=r(203);e.exports=function(e){return l((function(){return!!o[e]()||"​᠎"!=="​᠎"[e]()||n&&o[e].name!==e}))}},281:function(e,t,r){"use strict";r.r(t);r(110),r(201),r(48),r(279);var n={props:{username:{type:String,required:!0},id:{type:Number,required:!0}},data:function(){var e;return{newMessage:"",activeUserId:(null===(e=this.$store.getters.getActiveUser)||void 0===e?void 0:e.id)||null,messages:[]}},methods:{getChatKey:function(){return"chat_".concat(Math.min(this.id,this.activeUserId),"_").concat(Math.max(this.id,this.activeUserId))},loadMessages:function(){var e=this.getChatKey(),t=localStorage.getItem(e);return t?JSON.parse(t):[]},saveMessages:function(){var e=this.getChatKey();localStorage.setItem(e,JSON.stringify(this.messages))},sendMessage:function(){if(""!==this.newMessage.trim()){var e={sender:this.activeUserId,text:this.newMessage};this.messages.push(e),this.saveMessages(),this.newMessage=""}},updateMessages:function(e){var t=this.getChatKey();e.key===t&&(this.messages=JSON.parse(e.newValue))}},mounted:function(){this.activeUserId=this.$store.getters.getActiveUser.id,this.messages=this.loadMessages(),window.addEventListener("storage",this.updateMessages)},beforeDestroy:function(){window.removeEventListener("storage",this.updateMessages)},watch:{id:function(){this.activeUserId=this.$store.getters.getActiveUser.id,this.messages=this.loadMessages()}}},l=r(47),component=Object(l.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"w-full h-dvh flex border-l-2 justify-between flex-col py-4 px-4"},[t("div",{staticClass:"overflow-auto"},[t("div",{staticClass:"flex justify-between mx-4"},[t("h3",{staticClass:"font-title text-lg mb-4"},[e._v("Чат")]),e._v(" "),t("h3",[e._v(e._s(e.username))])]),e._v(" "),t("div",{staticClass:"p-4 bg-neutral-100 h-dvh rounded-md overflow-y-auto space-y-4"},e._l(e.messages,(function(r,n){return t("div",{key:n,class:r.sender===e.activeUserId?"flex justify-end":"flex justify-start"},[t("div",{class:r.sender===e.activeUserId?" bg-neutral-200 border border-neutral-300 text-black p-3 rounded-md max-w-xs":"bg-neutral-50 border p-3 rounded-md max-w-xs"},[e._v("\n                    "+e._s(r.text)+"\n                ")])])})),0)]),e._v(" "),t("div",{staticClass:"my-4 flex float mx-4"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.newMessage,expression:"newMessage"}],staticClass:"flex-grow border rounded-md mr-2 ps-2",attrs:{type:"text",placeholder:"Сообщение..."},domProps:{value:e.newMessage},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage.apply(null,arguments)},input:function(t){t.target.composing||(e.newMessage=t.target.value)}}}),e._v(" "),t("button",{staticClass:"bg-primary rounded-md text-black h-[36px] w-[36px] flex items-center justify-center",on:{click:e.sendMessage}},[t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"}},[t("title",[e._v("send-circle")]),e._v(" "),t("path",{attrs:{d:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M8,7.71V11.05L15.14,12L8,12.95V16.29L18,12L8,7.71Z"}})])])])])}),[],!1,null,null,null);t.default=component.exports},282:function(e,t,r){"use strict";r.r(t);var n={data:function(){return{isDialogVisible:!0,users:[]}},computed:{userList:function(){this.users=this.$store.getters.getUserList}},methods:{selectUser:function(e,t){this.$store.dispatch("setUser",{id:e,username:t}),this.closeDialog()},closeDialog:function(){this.isDialogVisible=!1}},mounted:function(){this.users=this.$store.getters.getUserList}},l=r(47),component=Object(l.a)(n,(function(){var e=this,t=e._self._c;return e.isDialogVisible?t("div",{staticClass:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",on:{click:function(t){return t.target!==t.currentTarget?null:e.closeDialog.apply(null,arguments)}}},[t("div",{staticClass:"bg-white p-5 rounded-lg max-w-lg mx-4 w-full"},[t("h2",{staticClass:"text-xl font-bold mb-4"},[e._v("Выберите пользователя")]),e._v(" "),t("ul",{staticClass:"list-none p-0 m-0"},e._l(e.users,(function(r){return t("li",{key:r.id,staticClass:"py-2 px-3 cursor-pointer hover:bg-gray-100",on:{click:function(t){return e.selectUser(r.id,r.username)}}},[t("span",[e._v(e._s(r.username))])])})),0)])]):e._e()}),[],!1,null,null,null);t.default=component.exports},283:function(e,t,r){"use strict";r.r(t);var n={data:function(){return{loading:!0}},computed:{userList:function(){return this.$store.getters.getUserList},activeUser:function(){return this.$store.getters.getActiveUser}},methods:{selectUser:function(e,t){this.$emit("userSelected",{userId:e,userName:t})}},watch:{activeUser:function(e){e&&e.id&&(this.loading=!1)},userList:function(e){e.length&&this.activeUser&&this.activeUser.id&&(this.loading=!1)}},mounted:function(){this.activeUser&&this.activeUser.id&&(this.loading=!1)}},l=r(47),component=Object(l.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"w-1/4 h-full"},[e.loading?t("div",{staticClass:"flex items-center justify-center h-dvh"},[t("div",{staticClass:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-e-transparent align-[-0.125em] text-surface motion-reduce:animate-[spin_1.5s_linear_infinite] dark:text-black",attrs:{role:"status"}}),e._v(" "),t("span",{staticClass:"!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]"},[e._v("Loading...")])]):t("div",{staticClass:"h-full"},[t("div",{staticClass:"bg-neutral-200 rounded-lg m-2"},[t("div",{staticClass:"p-2 text-center"},[t("img",{attrs:{src:"https://tools-api.webcrumbs.org/image-placeholder/32/32/user/".concat(e.activeUser.id),alt:""}}),e._v(" "),t("p",{staticClass:"font-light text-sm"},[e._v("Текущий пользователь")]),e._v(" "),t("p",{staticClass:"font-medium text-xl"},[e._v(e._s(e.activeUser.username))])])]),e._v(" "),e._m(0),e._v(" "),t("ul",{staticClass:"space-y-2"},e._l(e.userList,(function(r){return t("li",{key:r.id,staticClass:"flex items-center space-x-4 mx-3 hover:bg-neutral-300 hover:p-1 hover:rounded-md cursor-pointer",on:{click:function(t){return e.selectUser(r.id,r.username)}}},[t("img",{staticClass:"w-8 h-8 rounded-full object-cover",attrs:{src:"https://tools-api.webcrumbs.org/image-placeholder/32/32/user/".concat(r.id),alt:"user".concat(r.id)}}),e._v(" "),t("span",{staticClass:"p-2"},[e._v(e._s(r.username))])])})),0)])])}),[function(){var e=this._self._c;return e("h3",{staticClass:"font-title text-lg mb-4 w-full border-b"},[e("p",{staticClass:"ml-2"},[this._v("Друзья")])])}],!1,null,null,null);t.default=component.exports},284:function(e,t,r){"use strict";r.r(t);r(32),r(201);var n=r(1),l=r(281),o=r(282),c=r(283),d=n.a.extend({name:"IndexPage",components:{dialogWindow:o.default,chat:l.default,userList:c.default},data:function(){return{loading:!0,userInfo:{id:void 0,name:void 0}}},methods:{navigateToUser:function(e){var t=e.userId,r=e.userName;this.userInfo.id=Number(t),this.userInfo.name=r}}}),v=r(47),component=Object(v.a)(d,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"container flex justify-center items-center mx-auto"},[t("dialog-window"),e._v(" "),t("div",{staticClass:"border rounded-md w-full h-dvh"},[t("div",{staticClass:"flex"},[t("userList",{on:{userSelected:e.navigateToUser}}),e._v(" "),e.userInfo.id?t("chat",{attrs:{username:e.userInfo.name,id:e.userInfo.id}}):t("div",{staticClass:"w-full h-dvh border-2 rounded-md p-2 text-center"},[t("span",{staticClass:"text-2xl font-semibold"},[e._v("Выберите пользователя из друзей")])])],1)])],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Chat:r(281).default})}}]);